(window.webpackJsonp=window.webpackJsonp||[]).push([[92],{407:function(e,t,a){"use strict";a.r(t);var s=a(27),n=Object(s.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"almalinux-9-openscap-guide"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#almalinux-9-openscap-guide"}},[e._v("#")]),e._v(" AlmaLinux 9 OpenSCAP Guide")]),e._v(" "),t("p",[e._v("This guide was developed AlmaLinux 9 OS.\nYou can find some general information about OpenSCAP and how to enable OpenSCAP packages in the "),t("a",{attrs:{href:"https://wiki.almalinux.org/documentation/openscap-guide.html#about-openscap",target:"_blank",rel:"noopener noreferrer"}},[e._v("About OpenSCAP"),t("OutboundLink")],1),e._v(" section.")]),e._v(" "),t("h2",{attrs:{id:"validate-data-stream-file"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#validate-data-stream-file"}},[e._v("#")]),e._v(" Validate Data Stream File")]),e._v(" "),t("p",[e._v("A single source data stream file includes XCCDF content. Run the following command to validate a source data stream file against its schema:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('oscap ds sds-validate /usr/share/xml/scap/ssg/content/ssg-almalinux9-ds.xml \\ && echo "ok" || echo "exit code = $? not ok"\n')])])]),t("p",[e._v("The command output returns "),t("em",[e._v("ok")]),e._v(" if the data-stream file is valid.")]),e._v(" "),t("p",[e._v("The part in quotes is the full path to the security content file being examined.")]),e._v(" "),t("h2",{attrs:{id:"displaying-information-using-oscap"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#displaying-information-using-oscap"}},[e._v("#")]),e._v(" Displaying information, using "),t("code",[e._v("oscap")])]),e._v(" "),t("p",[e._v("The "),t("code",[e._v("oscap -V")]),e._v(" command displays information such as the specifications which the version of oscap supports; capabilities of the oscap version; where schema, CPE, and probe files are stored; inbuilt CPE names; supported OVAL objects and associated SCAP probes.")]),e._v(" "),t("p",[e._v("As an example of an output you will see this:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("OpenSCAP command line tool (oscap) 1.3.6\nCopyright 2009--2021 Red Hat Inc., Durham, North Carolina.\n\n==== Supported specifications ====\nSCAP Version: 1.3\nXCCDF Version: 1.2\nOVAL Version: 5.11.1\nCPE Version: 2.3\nCVSS Version: 2.0\nCVE Version: 2.0\nAsset Identification Version: 1.1\nAsset Reporting Format Version: 1.1\nCVRF Version: 1.1\n\n==== Capabilities added by auto-loaded plugins ====\nNo plugins have been auto-loaded...\n\n==== Paths ====\nSchema files: /usr/share/openscap/schemas\nDefault CPE files: /usr/share/openscap/cpe\n\n==== Inbuilt CPE names ====\nRed Hat Enterprise Linux - cpe:/o:redhat:enterprise_linux:-\nRed Hat Enterprise Linux 5 - cpe:/o:redhat:enterprise_linux:5\n...\nCommunity Enterprise Operating System 8 - cpe:/o:centos:centos:8\nAlmaLinux 8 - cpe:/o:almalinux:almalinux:8\nAlmaLinux 9 - cpe:/o:almalinux:almalinux:9\nFedora 32 - cpe:/o:fedoraproject:fedora:32\n...\n\n==== Supported OVAL objects and associated OpenSCAP probes ====\nOVAL family   OVAL object                  OpenSCAP probe\n----------    ----------                   ----------\nindependent   environmentvariable          probe_environmentvariable\nindependent   environmentvariable58        probe_environmentvariable58\n...\nunix          xinetd                       probe_xinetd\n")])])]),t("h2",{attrs:{id:"displaying-available-profiles"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#displaying-available-profiles"}},[e._v("#")]),e._v(" Displaying Available Profiles")]),e._v(" "),t("p",[e._v("A profile consists of common security suggestions that are related to any AlmaLinux installation. Profiles also have supplementary recommendations for the system to use. So, the oscap info command is used to see if available profiles are currently supported by the SCAP Security Guide which is a checklist file.")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("oscap info /usr/share/xml/scap/ssg/content/ssg-almalinux9-ds.xml\n")])])]),t("p",[e._v("The part in quotes is the full path to the security content file being examined.")]),e._v(" "),t("p",[e._v("As an example of displaying available profiles output you'll see next:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("Document type: Source Data Stream\nImported: 2022-05-25T01:55:58\n\nStream: scap_org.open-scap_datastream_from_xccdf_ssg-almalinux9-xccdf-1.2.xml\nGenerated: (null)\nVersion: 1.3\nChecklists:\n\tRef-Id: scap_org.open-scap_cref_ssg-almalinux9-xccdf-1.2.xml\nWARNING: Datastream component 'scap_org.open-scap_cref_oval-org.almalinux.alsa-9.xml.bz2' points out to the remote 'https://security.almalinux.org/oval/org.almalinux.alsa-9.xml.bz2'. Use the '--fetch-remote-resources' option to download it.\nWARNING: Skipping 'https://security.almalinux.org/oval/org.almalinux.alsa-9.xml.bz2' file which is referenced from datastream\n\t\tStatus: draft\n\t\tGenerated: 2022-05-24\n\t\tResolved: true\n\t\tProfiles:\n\t\t\tTitle: ANSSI-BP-028 (enhanced)\n\t\t\t\tId: xccdf_org.ssgproject.content_profile_anssi_bp28_enhanced\n\t\t\tTitle: ANSSI-BP-028 (high)\n\t\t\t\tId: xccdf_org.ssgproject.content_profile_anssi_bp28_high\n\t\t\tTitle: ANSSI-BP-028 (intermediary)\n\t\t\t\tId: xccdf_org.ssgproject.content_profile_anssi_bp28_intermediary\n\t\t\tTitle: ANSSI-BP-028 (minimal)\n\t\t\t\tId: xccdf_org.ssgproject.content_profile_anssi_bp28_minimal\n\t\t\tTitle: [DRAFT] CIS AlmaLinux 9 Benchmark for Level 2 - Server\n\t\t\t\tId: xccdf_org.ssgproject.content_profile_cis\n\t\t\tTitle: [DRAFT] CIS AlmaLinux 9 Benchmark for Level 1 - Server\n\t\t\t\tId: xccdf_org.ssgproject.content_profile_cis_server_l1\n\t\t\tTitle: [DRAFT] CIS AlmaLinux 9 Benchmark for Level 1 - Workstation\n\t\t\t\tId: xccdf_org.ssgproject.content_profile_cis_workstation_l1\n\t\t\tTitle: [DRAFT] CIS AlmaLinux 9 Benchmark for Level 2 - Workstation\n\t\t\t\tId: xccdf_org.ssgproject.content_profile_cis_workstation_l2\n\t\t\tTitle: [DRAFT] Unclassified Information in Non-federal Information Systems and Organizations (NIST 800-171)\n\t\t\t\tId: xccdf_org.ssgproject.content_profile_cui\n\t\t\tTitle: Australian Cyber Security Centre (ACSC) Essential Eight\n\t\t\t\tId: xccdf_org.ssgproject.content_profile_e8\n\t\t\tTitle: Health Insurance Portability and Accountability Act (HIPAA)\n\t\t\t\tId: xccdf_org.ssgproject.content_profile_hipaa\n\t\t\tTitle: Australian Cyber Security Centre (ACSC) ISM Official\n\t\t\t\tId: xccdf_org.ssgproject.content_profile_ism_o\n\t\t\tTitle: [DRAFT] Protection Profile for General Purpose Operating Systems\n\t\t\t\tId: xccdf_org.ssgproject.content_profile_ospp\n\t\t\tTitle: PCI-DSS v3.2.1 Control Baseline for Red Hat Enterprise Linux 9\n\t\t\t\tId: xccdf_org.ssgproject.content_profile_pci-dss\n\t\t\tTitle: [DRAFT] DISA STIG for Red Hat Enterprise Linux 9\n\t\t\t\tId: xccdf_org.ssgproject.content_profile_stig\n\t\t\tTitle: [DRAFT] DISA STIG with GUI for Red Hat Enterprise Linux 9\n\t\t\t\tId: xccdf_org.ssgproject.content_profile_stig_gui\n\t\tReferenced check files:\n\t\t\tssg-almalinux9-oval.xml\n\t\t\t\tsystem: http://oval.mitre.org/XMLSchema/oval-definitions-5\n\t\t\tssg-almalinux9-ocil.xml\n\t\t\t\tsystem: http://scap.nist.gov/schema/ocil/2\n\t\t\toval-org.almalinux.alsa-9.xml.bz2\n\t\t\t\tsystem: http://oval.mitre.org/XMLSchema/oval-definitions-5\nChecks:\n\tRef-Id: scap_org.open-scap_cref_ssg-almalinux9-oval.xml\n\tRef-Id: scap_org.open-scap_cref_ssg-almalinux9-ocil.xml\n\tRef-Id: scap_org.open-scap_cref_--builddir--build--BUILD--scap-security-guide-0.1.60--build--ssg-almalinux9-cpe-oval.xml\n\tRef-Id: scap_org.open-scap_cref_oval-org.almalinux.alsa-9.xml.bz2\nDictionaries:\n\tRef-Id: scap_org.open-scap_cref_--builddir--build--BUILD--scap-security-guide-0.1.60--build--ssg-almalinux9-cpe-dictionary.xml\n")])])]),t("h2",{attrs:{id:"view-information-about-a-profile"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#view-information-about-a-profile"}},[e._v("#")]),e._v(" View information about a profile")]),e._v(" "),t("p",[e._v("The "),t("code",[e._v("--profile")]),e._v(" option is useful to get information about a specific profile.")]),e._v(" "),t("p",[e._v("For example:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("oscap info --profile xccdf_org.ssgproject.content_profile_hipaa /usr/share/xml/scap/ssg/content/ssg-almalinux9-ds.xml\n")])])]),t("p",[e._v("There's an output example:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("Document type: Source Data Stream\nImported: 2022-05-25T01:55:58\n\nStream: scap_org.open-scap_datastream_from_xccdf_ssg-almalinux9-xccdf-1.2.xml\nGenerated: (null)\nVersion: 1.3\nWARNING: Datastream component 'scap_org.open-scap_cref_oval-org.almalinux.alsa-9.xml.bz2' points out to the remote 'https://security.almalinux.org/oval/org.almalinux.alsa-9.xml.bz2'. Use '--fetch-remote-resources' option to download it.\nWARNING: Skipping 'https://security.almalinux.org/oval/org.almalinux.alsa-9.xml.bz2' file which is referenced from datastream\nProfile\n\tTitle: Health Insurance Portability and Accountability Act (HIPAA)\n\tId: xccdf_org.ssgproject.content_profile_hipaa\n\n\tDescription: The HIPAA Security Rule establishes U.S. national standards to protect individualsâ€™ electronic personal health information that is created, received, used, or maintained by a covered entity. The Security Rule requires appropriate administrative, physical and technical safeguards to ensure the confidentiality, integrity, and security of electronic protected health information.  This profile configures AlmaLinux 9 to the HIPAA Security Rule identified for securing of electronic protected health information. Use of this profile in no way guarantees or makes claims against legal compliance against the HIPAA Security Rule(s).\n")])])]),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),t("p",[e._v("You can see a warning about remote data stream components when viewing information about XCCDF profiles. The data stream file contains information on where to download these components - OVAL definitions. You can ignore this warning now, but you must use the "),t("code",[e._v("--fetch-remote-resources")]),e._v(" option when performing an evaluation. This option allows OSCAP to download these resources.")])]),e._v(" "),t("h2",{attrs:{id:"scanning-the-system"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#scanning-the-system"}},[e._v("#")]),e._v(" Scanning the system")]),e._v(" "),t("p",[e._v("The most effective use of the oscap utility is the feature to perform configuration and vulnerability scans of a local system. The "),t("code",[e._v("oscap xccdf eval")]),e._v(" command is useful to scan a system against an XCCDF profile.")]),e._v(" "),t("p",[e._v("The output of this command shows a scan operation. The results are shown in a terminal window, as well as saved in XML and HTML formats in the two directories. One directory is /tmp, and the other is the "),t("strong",[e._v("~home/user")]),e._v(" catalog that you choose by yourself where you'd like to save the results. Any rule in a profile that results in a fail potentially requires the system to be reconfigured.")]),e._v(" "),t("p",[e._v("Here's an example of running the "),t("code",[e._v("oscap xccdf eval")]),e._v(" command against a determined profile:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("sudo oscap xccdf eval  --profile hipaa   --fetch-remote-resources   --results /tmp/ssg-results.xml   --report ~/report/ssg-results.html     /usr/share/xml/scap/ssg/content/ssg-almalinux9-ds.xml\n")])])]),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),t("p",[e._v("You must use the "),t("code",[e._v("--fetch-remote-resources")]),e._v(" option when performing an evaluation. This option allows OSCAP to download these remote resources which are OVAL definitions. Information on where to download them is included in the data stream file.")])]),e._v(" "),t("p",[e._v("Here is an example output of this command:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("Downloading: https://security.almalinux.org/oval/org.almalinux.alsa-9.xml.bz2 ... ok\n--- Starting Evaluation ---\n\nTitle   Verify File Hashes with RPM\nRule    xccdf_org.ssgproject.content_rule_rpm_verify_hashes\nResult  pass\n...\nTitle   Distribute the SSH Server configuration to multiple files in a config directory.\nRule    xccdf_org.ssgproject.content_rule_sshd_use_directory_configuration\nResult  pass\n")])])]),t("p",[e._v("The HTML report which you can view in a browser looks like as follows:")]),e._v(" "),t("p",[t("img",{attrs:{src:"/images/openscap-9_evaluation_report.png",alt:"image"}})]),e._v(" "),t("h2",{attrs:{id:"generating-a-full-security-guide"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#generating-a-full-security-guide"}},[e._v("#")]),e._v(" Generating a Full Security Guide")]),e._v(" "),t("p",[e._v("To create a full security guide for a system based on an XCCDF profile, use the "),t("code",[e._v("oscap xccdf generate guide")]),e._v(" command. Pay attention, that like in the previous command you choose your home path "),t("strong",[e._v("~home/user")]),e._v(" to save the HTML security guide.")]),e._v(" "),t("p",[e._v("Use the oscap xccdf generate guide command to create a full security guide that provides a catalog of security-relevant configuration settings for the system. Security guides often include example bash remediation scripts and Ansible snippets that can be helpful when run against the system to automatically resolve issues. Be aware that you should test remediation scripts on systems within a test environment as actions taken by scripts may not be desirable for your enterprise.")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("sudo oscap xccdf generate guide --profile hipaa   --fetch-remote-resources \\\n/usr/share/xml/scap/ssg/content/ssg-almalinux9-ds.xml > ~/report/security_guide.html\n")])])]),t("p",[e._v("The HTML report which you can view in a browser looks like as follows:")]),e._v(" "),t("p",[t("img",{attrs:{src:"/images/openscap-9_full_security_guide.png",alt:"image"}})]),e._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),t("p",[e._v("Run the "),t("code",[e._v("oscap info ssg-results.xml")]),e._v(" command from the "),t("em",[e._v("/tmp")]),e._v(" directory to review the results XML file. You can get information like remediation scripts from it.")])]),e._v(" "),t("h2",{attrs:{id:"remediating-a-system-for-compliance-with-a-security-profile"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#remediating-a-system-for-compliance-with-a-security-profile"}},[e._v("#")]),e._v(" Remediating a System For Compliance With a Security Profile")]),e._v(" "),t("p",[e._v("Performing remediation steps is recommended after a fresh installation without any profile selected while installation. OSCAP commands can apply remediation steps where the system fails to comply with an XCCDF profile. You can find these rules that result in fail status during scanning the system and generating a security guide.")]),e._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),t("p",[e._v("Note, that remediation doesn't guarantee compliance with an XCCDF profile if the system configuration has been changed. Also, remediation steps can make changes to a system and alter how a system functions and the steps can't be automatically reverted once applied. So it's not recommended to run remediation steps on a production system without testing.")])]),e._v(" "),t("p",[e._v("Run the "),t("code",[e._v("oscap xccdf eval")]),e._v(" command with "),t("code",[e._v("--profile")]),e._v(" and "),t("code",[e._v("--remediate")]),e._v(" options to allow OSCAP automatically apply remediation steps:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("sudo oscap xccdf eval --profile hipaa \\\n  --remediate /usr/share/xml/scap/ssg/content/ssg-almalinux9-ds.xml\n")])])]),t("p",[e._v("After that, reboot the system and scan the system again to validate the changes.")]),e._v(" "),t("p",[e._v("It's possible to generate remediation scripts for later use allowing to review and modify actions before applying these changes.\nThe following command generates a remediation script that provides all of the remediations that are present in a profile. Run the command against the data stream file:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("oscap xccdf generate fix --profile hipaa --fix-type bash \\\n --output all-remediations.sh /usr/share/xml/scap/ssg/content/ssg-almalinux9-ds.xml\n")])])]),t("p",[e._v("To generate a remediation script with specific remediations run a scan against an XCCDF file and use an XML results file:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("oscap xccdf generate fix --profile hipaa --fix-type bash  --output remediations.sh /tmp/ssg-results.xml\n")])])]),t("h2",{attrs:{id:"auditing-for-vulnerabilities-by-using-oval-definitions"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#auditing-for-vulnerabilities-by-using-oval-definitions"}},[e._v("#")]),e._v(" Auditing for Vulnerabilities By Using OVAL Definitions")]),e._v(" "),t("h3",{attrs:{id:"about-oval"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#about-oval"}},[e._v("#")]),e._v(" About OVAL")]),e._v(" "),t("p",[e._v("The OVAL definition file is used to scan the system in order to verify if applicable errata have been installed. To see the information about supported AlmaLinux OS versions and their public OVAL streams, please, visit the "),t("a",{attrs:{href:"https://wiki.almalinux.org/documentation/oval-streams.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("AlmaLinux OVAL streams"),t("OutboundLink")],1),e._v(" wiki page.")]),e._v(" "),t("p",[e._v("There are two types of OVAL files: "),t("em",[e._v("org.almalinux.alsa-9.xml")]),e._v(" and "),t("em",[e._v("org.almalinux.alsa-9.xml.bz2")]),e._v(", which contain the same information but archived.")]),e._v(" "),t("h3",{attrs:{id:"getting-an-oval-file"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#getting-an-oval-file"}},[e._v("#")]),e._v(" Getting an OVAL file")]),e._v(" "),t("p",[e._v("The first thing to run the OVAL scan is to download a file from an AlmaLinux OVAL stream using the browser or the "),t("code",[e._v("wget")]),e._v(" command:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("wget https://security.almalinux.org/oval/org.almalinux.alsa-9.xml\n")])])]),t("p",[e._v("or")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("wget https://security.almalinux.org/oval/org.almalinux.alsa-9.xml.bz2\n")])])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),t("p",[e._v("Don't forget to extract the OVAL file if you downloaded the compressed file:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("bzip2 -d org.almalinux.alsa-9.xml.bz2\n")])])])]),e._v(" "),t("h3",{attrs:{id:"displaying-information-about-an-oval-file"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#displaying-information-about-an-oval-file"}},[e._v("#")]),e._v(" Displaying information about an OVAL file")]),e._v(" "),t("p",[e._v("Run the "),t("code",[e._v("oscap info")]),e._v(" command to display information about an OVAL file:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("oscap info org.almalinux.alsa-9.xml\n")])])]),t("p",[e._v("Here is an example output you can see:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("Document type: OVAL Definitions\nOVAL version: 5.10\nGenerated: 2022-09-16T20:30:33\nImported: 2022-09-16T22:30:33\n")])])]),t("h3",{attrs:{id:"validating-an-oval-file"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#validating-an-oval-file"}},[e._v("#")]),e._v(" Validating an OVAL file")]),e._v(" "),t("p",[e._v("Run the "),t("code",[e._v("oscap validate")]),e._v(" command to validate an OVAL file against its schema:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('oscap oval validate org.almalinux.alsa-9.xml \\\n  && echo "ok" || echo "exit code = $? not ok"\n')])])]),t("p",[e._v("The command output returns "),t("em",[e._v("ok")]),e._v(" if the files are valid and properly structured.")]),e._v(" "),t("h3",{attrs:{id:"performing-a-scan"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#performing-a-scan"}},[e._v("#")]),e._v(" Performing a scan")]),e._v(" "),t("p",[e._v("Run the following command to perform an audit scan of the AlmaLinux:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("sudo oscap oval eval --results /tmp/alsa-results-oval.xml \\\n--report ~/report/alsa-report-oval.html org.almalinux.alsa-9.xml\n")])])]),t("p",[e._v("Here is an example output you can see:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("Definition oval:org.almalinux.alsa:def:20226224: false\n...\nDefinition oval:org.almalinux.alsa:def:20225249: true\n...\nDefinition oval:org.almalinux.alsa:def:20221729: false\nDefinition oval:org.almalinux.alsa:def:20221728: false\nEvaluation done\n")])])]),t("p",[e._v("A result of "),t("em",[e._v("false")]),e._v(" means that the patch has been applied. A result of "),t("em",[e._v("true")]),e._v(" means that the system is vulnerable and the patch is yet to be applied.")]),e._v(" "),t("p",[e._v("Run the following command to generate the HTML report to view in a browser:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("sudo oscap oval generate report /tmp/alsa-results-oval.xml \\\n/home/sonia/report/alsa-report-oval.html\n")])])]),t("p",[e._v("Here is an example of the HTML report:")]),e._v(" "),t("p",[t("img",{attrs:{src:"/images/openscap-9_oval_scan.png",alt:"image"}})]),e._v(" "),t("h2",{attrs:{id:"scap-workbench"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#scap-workbench"}},[e._v("#")]),e._v(" SCAP Workbench")]),e._v(" "),t("p",[e._v("One more way to scan a local or a remote system is SCAP Workbench. The SCAP Workbench utility also allows generating reports based on scan evaluations.")]),e._v(" "),t("p",[e._v("To install SCAP Workbench run the following command as root:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("sudo dnf install scap-workbench\n")])])]),t("p",[e._v("If the "),t("code",[e._v("scap-security-guide")]),e._v(" package wasn't installed from the package repository before, you need to install it too, to use SCAP Workbench effectively. All the other packages and dependencies are installed and updated automatically.")]),e._v(" "),t("p",[e._v("After SCAP Workbench is installed, it should appear in your desktop environments application menu and you can run it.")]),e._v(" "),t("p",[t("img",{attrs:{src:"/images/openscap-9_workbench.png",alt:"image"}})]),e._v(" "),t("p",[e._v("After you start Workbench, a dialog window will offer you to choose which SCAP Security Guide to open.")]),e._v(" "),t("p",[e._v("When one of the guides is chosen, the next SCAP Workbench window appears. There is a menu, which offers you some more options to select before scanning the system.")]),e._v(" "),t("p",[t("img",{attrs:{src:"/images/openscap-9_workbench_profiles.png",alt:"image"}})]),e._v(" "),t("p",[t("strong",[t("em",[e._v("File")])]),e._v("\nThis option offers to load or save SCAP-related content. The "),t("em",[e._v("Save Customization Only")]),e._v(" item is useful if you selected 'Customization Only' and you want to save it as an XCCDF XML file. The "),t("em",[e._v("Save All")]),e._v(" item is useful to save SCAP files to the selected directory or as an RPM package.")]),e._v(" "),t("p",[t("strong",[t("em",[e._v("Customization")])]),e._v("\nThis option informs you about the customization used for the given security policy. The default is no customization.")]),e._v(" "),t("p",[t("strong",[t("em",[e._v("Profile")])]),e._v("\nThis option allows choosing the security profile by clicking this menu. You can create a new profile by clicking the Customize button.")]),e._v(" "),t("p",[e._v("Here is the list of available profiles that can be used to evaluate the system:")]),e._v(" "),t("ul",[t("li",[e._v("ANSSI-BP-028 (enhanced)")]),e._v(" "),t("li",[e._v("ANSSI-BP-028 (high)")]),e._v(" "),t("li",[e._v("ANSSI-BP-028 (intermediary)")]),e._v(" "),t("li",[e._v("ANSSI-BP-028 (minimal)")]),e._v(" "),t("li",[e._v("[DRAFT] CIS AlmaLinux 9 Benchmark for Level 2 - Server")]),e._v(" "),t("li",[e._v("[DRAFT] CIS AlmaLinux 9 Benchmark for Level 1 - Server")]),e._v(" "),t("li",[e._v("[DRAFT] CIS AlmaLinux 9 Benchmark for Level 1 - Workstation")]),e._v(" "),t("li",[e._v("[DRAFT] CIS AlmaLinux 9 Benchmark for Level 2 - Workstation")]),e._v(" "),t("li",[e._v("[DRAFT] Unclassified Information in Non-federal Information Systems and Organizations (NIST 800-171)")]),e._v(" "),t("li",[e._v("Australian Cyber Security Centre (ACSC) Essential Eight")]),e._v(" "),t("li",[e._v("Health Insurance Portability and Accountability Act (HIPAA)")]),e._v(" "),t("li",[e._v("Australian Cyber Security Centre (ACSC) ISM Official")]),e._v(" "),t("li",[e._v("[DRAFT] Protection Profile for General Purpose Operating Systems")]),e._v(" "),t("li",[e._v("PCI-DSS v3.2.1 Control Baseline for Red Hat Enterprise Linux 9")]),e._v(" "),t("li",[e._v("[DRAFT] DISA STIG for Red Hat Enterprise Linux 9")]),e._v(" "),t("li",[e._v("[DRAFT] DISA STIG with GUI for Red Hat Enterprise Linux 9")])]),e._v(" "),t("p",[t("strong",[t("em",[e._v("Target")])]),e._v("\nHere you can select the system you want to be evaluated - a local or a remote one.")]),e._v(" "),t("p",[t("strong",[t("em",[e._v("Selected Rules")])]),e._v("\nThis field shows you a list of security rules that security policy applies to.")]),e._v(" "),t("p",[t("strong",[t("em",[e._v("Fetch remote resources")])]),e._v("\nYou need to check this box in case you want the scanner to download remote OVAL content defined in an XML file.")]),e._v(" "),t("p",[t("strong",[t("em",[e._v("Remediate")])]),e._v("\nIf you check this box, SCAP Workbench will attempt to correct system settings that would fail to match the state defined by the policy.")]),e._v(" "),t("p",[e._v("After the profile is chosen, press the SCAN button. You will see how the process is going on the status bar.")]),e._v(" "),t("p",[t("img",{attrs:{src:"/images/openscap-9_workbench_scan.png",alt:"image"}})]),e._v(" "),t("p",[e._v("When the scan is completed, you can "),t("em",[e._v("Save Results")]),e._v(" as an XCCDF Result file, ARF, or HTML Report, in case you need them. If you press the "),t("em",[e._v("Show Report")]),e._v(" button, it'll be displayed in a browser:")]),e._v(" "),t("p",[t("img",{attrs:{src:"/images/openscap-9_workbench_report.png",alt:"image"}})])])}),[],!1,null,null,null);t.default=n.exports}}]);